2025-09-12 13:30:07.448 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 13:30:07.750 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 13:30:07.750 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 13:30:07.794 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 13:30:07.794 +07:00 [INF] Hosting environment: Development
2025-09-12 13:30:07.794 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 13:30:09.727 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 13:30:09.929 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 209.8489ms
2025-09-12 13:30:09.931 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 13:30:16.643 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 13:30:16.643 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 13:30:16.658 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 14.9654ms
2025-09-12 13:30:16.747 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 104.0979ms
2025-09-12 13:30:16.775 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 13:30:16.961 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 186.0653ms
2025-09-12 13:30:21.595 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User - null null
2025-09-12 13:30:21.608 +07:00 [INF] Executing endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 13:30:21.627 +07:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers() on controller UserController (EVServiceCenter.API).
2025-09-12 13:30:24.647 +07:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
2025-09-12 13:30:24.694 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-12 13:30:24.703 +07:00 [INF] Executed action UserController.GetAllUsers (EVServiceCenter.API) in 3073.1214ms
2025-09-12 13:30:24.704 +07:00 [INF] Executed endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 13:30:24.712 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User - 200 null application/json; charset=utf-8 3116.733ms
2025-09-12 13:30:33.555 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 137
2025-09-12 13:30:33.565 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:30:33.566 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:30:33.569 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:30:33.578 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:30:33.719 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-12 13:30:33.732 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 153.4029ms
2025-09-12 13:30:33.732 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:30:33.732 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/problem+json; charset=utf-8 176.7259ms
2025-09-12 13:39:22.435 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 57
2025-09-12 13:39:22.464 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:39:22.464 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:39:22.465 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 13:39:22.468 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:39:22.778 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 13:39:22.780 +07:00 [WRN] Login failed: Username PhamNghia not found
2025-09-12 13:39:22.781 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:39:22.782 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 313.1713ms
2025-09-12 13:39:22.782 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 13:39:22.782 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 401 null application/json; charset=utf-8 347.0257ms
2025-09-12 13:40:14.079 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 176
2025-09-12 13:40:14.084 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:40:14.084 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:40:14.084 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:14.084 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:40:14.087 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-12 13:40:14.087 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 3.1252ms
2025-09-12 13:40:14.088 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:14.088 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/problem+json; charset=utf-8 9.3248ms
2025-09-12 13:40:23.094 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 176
2025-09-12 13:40:23.094 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:40:23.094 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:40:23.095 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:23.095 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:40:23.171 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:40:23.186 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:40:23.816 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:40:23.840 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 13:40:24.171 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:40:24.171 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 1076.6434ms
2025-09-12 13:40:24.171 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:24.172 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 1077.4136ms
2025-09-12 13:40:57.395 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 176
2025-09-12 13:40:57.395 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:40:57.395 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:40:57.428 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:57.430 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:40:57.446 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:40:57.449 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:40:57.622 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:40:57.625 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 13:40:57.865 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:40:57.865 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 435.5708ms
2025-09-12 13:40:57.865 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:40:57.866 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 471.1199ms
2025-09-12 13:41:15.730 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 162
2025-09-12 13:41:15.730 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:41:15.730 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:41:15.730 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:41:15.730 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:41:15.731 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-12 13:41:15.731 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 1.22ms
2025-09-12 13:41:15.731 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:41:15.731 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/problem+json; charset=utf-8 1.9618ms
2025-09-12 13:41:34.262 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 176
2025-09-12 13:41:34.262 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:41:34.262 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:41:34.262 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:41:34.262 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:41:34.277 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:41:34.281 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:41:34.419 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:41:34.422 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 13:41:34.670 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:41:34.671 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 408.1532ms
2025-09-12 13:41:34.671 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:41:34.671 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 409.1062ms
2025-09-12 13:43:12.537 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 13:43:12.537 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:43:12.537 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:43:12.537 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:43:12.537 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:43:12.548 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:43:12.550 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:43:12.699 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:43:12.702 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4ce796e0-5d8b-4337-990f-c0cdadc6c608
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 13:43:12.858 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:43:12.858 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 320.9026ms
2025-09-12 13:43:12.858 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:43:12.858 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 347.6205ms
2025-09-12 13:45:54.074 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 57
2025-09-12 13:45:54.107 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:45:54.108 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:45:54.108 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 13:45:54.109 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:45:54.122 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 13:45:54.122 +07:00 [WRN] Login failed: Username PhamNghia not found
2025-09-12 13:45:54.122 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:45:54.123 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 13.9959ms
2025-09-12 13:45:54.123 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 13:45:54.123 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 401 null application/json; charset=utf-8 49.3132ms
2025-09-12 13:48:19.823 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 13:48:20.035 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 13:48:20.036 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 13:48:20.073 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 13:48:20.073 +07:00 [INF] Hosting environment: Development
2025-09-12 13:48:20.073 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 13:48:21.135 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 13:48:21.276 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 145.1676ms
2025-09-12 13:48:21.278 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 13:48:24.316 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 13:48:24.316 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 13:48:24.349 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 33.4014ms
2025-09-12 13:48:24.365 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.8989ms
2025-09-12 13:48:24.432 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 13:48:24.516 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 83.538ms
2025-09-12 13:48:32.974 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 13:48:32.980 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:48:32.980 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:48:32.983 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:48:33.002 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:49:23.835 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:49:23.862 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:49:24.262 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:49:24.299 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33c4adc1-efee-4886-8800-f8ab55b3ca8c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33c4adc1-efee-4886-8800-f8ab55b3ca8c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 13:49:45.747 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 13:49:45.812 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 72807.343ms
2025-09-12 13:49:45.812 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:49:45.817 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 72843.4171ms
2025-09-12 13:55:48.484 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 13:55:48.668 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 13:55:48.668 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 13:55:48.699 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 13:55:48.699 +07:00 [INF] Hosting environment: Development
2025-09-12 13:55:48.699 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 13:55:49.493 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 13:55:49.643 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 156.4852ms
2025-09-12 13:55:49.645 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 13:55:52.394 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 13:55:52.394 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 13:55:52.408 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 13.8508ms
2025-09-12 13:55:52.424 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.6738ms
2025-09-12 13:55:52.521 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 13:55:52.618 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 97.3704ms
2025-09-12 13:56:07.761 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 13:56:07.768 +07:00 [INF] CORS policy execution failed.
2025-09-12 13:56:07.769 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 13:56:07.772 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 13:56:07.796 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 13:56:55.789 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:56:55.822 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 13:56:56.237 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 13:56:56.257 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ecc534d9-baa3-4e1e-8e62-cb993f94e88e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ecc534d9-baa3-4e1e-8e62-cb993f94e88e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:11:04.503 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 14:11:04.714 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 14:11:04.715 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 14:11:04.747 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 14:11:04.747 +07:00 [INF] Hosting environment: Development
2025-09-12 14:11:04.747 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 14:11:05.506 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 14:11:05.675 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 176.3469ms
2025-09-12 14:11:05.676 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 14:11:08.072 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 14:11:08.072 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 14:11:08.087 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 15.1517ms
2025-09-12 14:11:08.104 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.469ms
2025-09-12 14:11:08.199 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 14:11:08.301 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 102.8087ms
2025-09-12 14:11:20.905 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 14:11:20.915 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:11:20.915 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:11:20.918 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:11:20.942 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:11:31.717 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:11:31.746 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:11:32.124 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:11:32.141 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1881b745-610a-4d87-a058-ece4c039119b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK__Users__RoleID__534D60F1". The conflict occurred in database "EVServiceCenterV2", table "dbo.UserRoles", column 'RoleID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1881b745-610a-4d87-a058-ece4c039119b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:11:42.568 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:11:42.633 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 21688.3047ms
2025-09-12 14:11:42.633 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:11:42.637 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 21732.6033ms
2025-09-12 14:18:32.366 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 14:18:32.373 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:18:32.373 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:18:32.375 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:18:32.376 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:18:39.761 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 14:18:40.019 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 14:18:40.020 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 14:18:40.047 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 14:18:40.047 +07:00 [INF] Hosting environment: Development
2025-09-12 14:18:40.047 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 14:18:41.449 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 14:18:41.657 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 214.7099ms
2025-09-12 14:18:41.658 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 14:18:43.477 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 14:18:43.477 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 14:18:43.488 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 11.6214ms
2025-09-12 14:18:43.508 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.6924ms
2025-09-12 14:18:43.594 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 14:18:43.682 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 88.1312ms
2025-09-12 14:19:04.851 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 14:19:04.858 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:19:04.858 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:19:04.874 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:19:04.901 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:19:08.326 +07:00 [INF] Executed DbCommand (48ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:19:08.388 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:19:09.108 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:19:09.140 +07:00 [INF] User registered: 0848022439
2025-09-12 14:19:09.183 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:19:09.207 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 4301.9778ms
2025-09-12 14:19:09.208 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:19:09.215 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 4365.8862ms
2025-09-12 14:21:26.464 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 179
2025-09-12 14:21:26.498 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:21:26.498 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:21:26.500 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:21:26.501 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:21:26.543 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:21:26.546 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:21:26.734 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:21:26.749 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:21:26.945 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:21:26.946 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 445.2005ms
2025-09-12 14:21:26.946 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:21:26.946 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 486.2083ms
2025-09-12 14:21:37.479 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 179
2025-09-12 14:21:37.479 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:21:37.479 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:21:37.479 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:21:37.479 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:21:37.495 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:21:37.497 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:21:37.617 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:21:37.621 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:21:37.738 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:21:37.739 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 259.0754ms
2025-09-12 14:21:37.739 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:21:37.739 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 259.8943ms
2025-09-12 14:22:24.470 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 14:22:24.471 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:22:24.471 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:22:24.471 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:22:24.471 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:22:24.477 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:22:24.481 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:22:24.622 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:22:24.626 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:22:24.869 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:22:24.869 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 397.8741ms
2025-09-12 14:22:24.869 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:22:24.869 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 398.8487ms
2025-09-12 14:22:54.799 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 14:22:54.829 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:22:54.829 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:22:54.829 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:22:54.829 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:22:54.840 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:22:54.921 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:22:54.922 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 92.3621ms
2025-09-12 14:22:54.922 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:22:54.922 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 152.3118ms
2025-09-12 14:23:04.993 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 14:23:04.993 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:23:04.993 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:23:04.993 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:23:04.993 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:23:04.996 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:23:04.998 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:23:05.084 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:23:05.084 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 90.896ms
2025-09-12 14:23:05.084 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:23:05.085 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 91.6764ms
2025-09-12 14:23:11.303 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 176
2025-09-12 14:23:11.303 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:23:11.303 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:23:11.303 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:23:11.303 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:23:11.306 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:23:11.308 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:23:11.445 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:23:11.448 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:23:11.659 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:23:11.659 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 355.823ms
2025-09-12 14:23:11.659 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:23:11.659 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 356.3753ms
2025-09-12 14:25:15.149 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 14:25:15.185 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:25:15.185 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:25:15.185 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:25:15.185 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:25:15.190 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:25:15.192 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:25:15.326 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:25:15.330 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d537344e-85fd-4737-8e5f-feb8e1e88865
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:25:15.586 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:25:15.587 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 401.7614ms
2025-09-12 14:25:15.587 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:25:15.587 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 438.1427ms
2025-09-12 14:25:30.808 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 14:25:31.079 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 14:25:31.080 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 14:25:31.125 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 14:25:31.125 +07:00 [INF] Hosting environment: Development
2025-09-12 14:25:31.125 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 14:25:32.469 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 14:25:32.654 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 192.2165ms
2025-09-12 14:25:32.656 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 14:25:34.542 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 14:25:34.542 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 14:25:34.573 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 31.3624ms
2025-09-12 14:25:34.591 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.9953ms
2025-09-12 14:25:34.676 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 14:25:34.773 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 97.4561ms
2025-09-12 14:25:42.736 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 14:25:42.743 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:25:42.743 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:25:42.747 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:25:42.769 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:25:52.833 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:25:52.864 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:25:53.234 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:25:53.250 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6e8fc9f5-d5aa-4b1b-bec5-db924e40e681
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6e8fc9f5-d5aa-4b1b-bec5-db924e40e681
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:30:17.338 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 14:30:17.555 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 14:30:17.555 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 14:30:17.605 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 14:30:17.605 +07:00 [INF] Hosting environment: Development
2025-09-12 14:30:17.605 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 14:30:18.532 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 14:30:18.694 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 167.3017ms
2025-09-12 14:30:18.696 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 14:30:21.897 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 14:30:21.897 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 14:30:21.910 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 12.9769ms
2025-09-12 14:30:21.924 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.0984ms
2025-09-12 14:30:22.005 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 14:30:22.105 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 99.864ms
2025-09-12 14:30:43.969 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 183
2025-09-12 14:30:43.980 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:30:43.980 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:30:44.050 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:30:44.077 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:30:47.455 +07:00 [INF] Executed DbCommand (66ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:30:47.499 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:30:48.218 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:30:48.242 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1ec27c36-c5c9-45c0-9c02-776801109d99
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1ec27c36-c5c9-45c0-9c02-776801109d99
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 14:30:48.555 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:30:48.563 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 4481.8453ms
2025-09-12 14:30:48.563 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:30:48.577 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 4608.0708ms
2025-09-12 14:42:57.714 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 14:42:57.900 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 14:42:57.900 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 14:42:57.931 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 14:42:57.931 +07:00 [INF] Hosting environment: Development
2025-09-12 14:42:57.931 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 14:42:58.766 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 14:42:58.962 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 202.6136ms
2025-09-12 14:42:58.964 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 14:44:51.087 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 14:44:51.095 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 14:44:51.166 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 79.0365ms
2025-09-12 14:44:51.180 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 85.5782ms
2025-09-12 14:44:51.247 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 14:44:51.343 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.8954ms
2025-09-12 14:45:28.290 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 65
2025-09-12 14:45:28.330 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:45:28.331 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:45:28.332 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:45:28.365 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:45:30.140 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 14:45:30.465 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 14:45:30.566 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 14:45:30.573 +07:00 [INF] User logged in: 0848022439
2025-09-12 14:45:30.605 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:45:30.611 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 2243.6617ms
2025-09-12 14:45:30.612 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:45:30.617 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 2327.3713ms
2025-09-12 14:46:21.036 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 66
2025-09-12 14:46:21.043 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:46:21.043 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:46:21.045 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:46:21.045 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:46:21.090 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 14:46:21.281 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0
OUTPUT 1
WHERE [UserID] = @p1;
2025-09-12 14:46:21.281 +07:00 [WRN] Login failed: Invalid password for 0848022439
2025-09-12 14:46:21.441 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:46:21.442 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 397.0733ms
2025-09-12 14:46:21.442 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:46:21.442 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 400 null application/json; charset=utf-8 406.2408ms
2025-09-12 14:46:26.347 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 65
2025-09-12 14:46:26.348 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:46:26.348 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:46:26.348 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:46:26.349 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:46:26.368 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 14:46:26.512 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 14:46:26.522 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 14:46:26.523 +07:00 [INF] User logged in: 0848022439
2025-09-12 14:46:26.524 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:46:26.524 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 175.1197ms
2025-09-12 14:46:26.524 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:46:26.524 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 176.5972ms
2025-09-12 14:47:35.684 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 66
2025-09-12 14:47:35.714 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:47:35.714 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:47:35.714 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:47:35.714 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:47:35.721 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 14:47:35.848 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0
OUTPUT 1
WHERE [UserID] = @p1;
2025-09-12 14:47:35.848 +07:00 [WRN] Login failed: Invalid password for 0848022439
2025-09-12 14:47:35.919 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:47:35.919 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 204.8699ms
2025-09-12 14:47:35.919 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:47:35.919 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 400 null application/json; charset=utf-8 234.9771ms
2025-09-12 14:47:44.145 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 65
2025-09-12 14:47:44.153 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:47:44.153 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:47:44.153 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:47:44.153 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:47:44.160 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 14:47:44.281 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 14:47:44.290 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 14:47:44.290 +07:00 [INF] User logged in: 0848022439
2025-09-12 14:47:44.290 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 14:47:44.290 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 137.4439ms
2025-09-12 14:47:44.290 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 14:47:44.291 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 145.6699ms
2025-09-12 14:49:41.827 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 14:49:41.827 +07:00 [INF] CORS policy execution failed.
2025-09-12 14:49:41.827 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 14:49:41.827 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 14:49:41.884 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 14:50:28.212 +07:00 [INF] Executed DbCommand (40ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:50:28.222 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 14:50:28.370 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 14:50:28.386 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ec40cc2e-7927-4128-9d96-c88939330b76
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ec40cc2e-7927-4128-9d96-c88939330b76
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 16:08:20.672 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 16:08:20.908 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 16:08:20.908 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 16:08:20.937 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 16:08:20.937 +07:00 [INF] Hosting environment: Development
2025-09-12 16:08:20.937 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 16:08:22.327 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 16:08:22.523 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 202.4138ms
2025-09-12 16:08:22.525 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 16:08:24.717 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 16:08:24.717 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 16:08:24.728 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 11.7133ms
2025-09-12 16:08:24.748 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.2098ms
2025-09-12 16:08:24.850 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 16:08:24.946 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.7447ms
2025-09-12 16:08:29.694 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User - null null
2025-09-12 16:08:29.701 +07:00 [INF] Executing endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 16:08:29.727 +07:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers() on controller UserController (EVServiceCenter.API).
2025-09-12 16:08:33.255 +07:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
2025-09-12 16:08:33.463 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-12 16:08:33.474 +07:00 [INF] Executed action UserController.GetAllUsers (EVServiceCenter.API) in 3743.0252ms
2025-09-12 16:08:33.474 +07:00 [INF] Executed endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 16:08:33.482 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User - 200 null application/json; charset=utf-8 3788.1412ms
2025-09-12 16:08:50.355 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User/8 - null null
2025-09-12 16:08:50.362 +07:00 [INF] Executing endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 16:08:50.376 +07:00 [INF] Route matched with {action = "GetUserById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserById(Int32) on controller UserController (EVServiceCenter.API).
2025-09-12 16:08:50.691 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 16:08:50.732 +07:00 [INF] Executing OkObjectResult, writing value of type 'EVServiceCenter.Core.DTOs.Response.UserResponseDto'.
2025-09-12 16:08:50.732 +07:00 [INF] Executed action UserController.GetUserById (EVServiceCenter.API) in 356.2797ms
2025-09-12 16:08:50.732 +07:00 [INF] Executed endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 16:08:50.733 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User/8 - 200 null application/json; charset=utf-8 378.2884ms
2025-09-12 16:10:49.866 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 178
2025-09-12 16:10:49.871 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:10:49.871 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:10:49.872 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:10:49.877 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:10:49.926 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-12 16:10:49.950 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 73.5095ms
2025-09-12 16:10:49.950 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:10:49.950 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/problem+json; charset=utf-8 84.572ms
2025-09-12 16:11:23.006 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 16:11:23.061 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:11:23.061 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:11:23.061 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:11:23.061 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:14:34.707 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:14:34.718 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:14:35.149 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 16:14:35.171 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:211dd981-3156-48f7-94fd-c679a0c16d3f
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:211dd981-3156-48f7-94fd-c679a0c16d3f
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 16:17:55.453 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:17:55.517 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 392456.0224ms
2025-09-12 16:17:55.517 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:17:55.518 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 392511.5333ms
2025-09-12 16:18:06.424 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 181
2025-09-12 16:18:06.424 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:18:06.424 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:18:06.424 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:18:06.424 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:18:13.794 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:18:13.796 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:18:13.919 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 16:18:13.922 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b3f16366-1f1a-4eb1-9d1d-ad421b9a2825
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b3f16366-1f1a-4eb1-9d1d-ad421b9a2825
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 16:18:19.899 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:18:19.900 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 13475.3757ms
2025-09-12 16:18:19.900 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:18:19.900 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 13476.3634ms
2025-09-12 16:42:39.144 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 16:42:39.395 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 16:42:39.396 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 16:42:39.436 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 16:42:39.436 +07:00 [INF] Hosting environment: Development
2025-09-12 16:42:39.436 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 16:42:40.670 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 16:42:40.833 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 171.2643ms
2025-09-12 16:42:40.834 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 16:42:44.367 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 16:42:44.368 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 16:42:44.389 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 21.9989ms
2025-09-12 16:42:44.406 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.4034ms
2025-09-12 16:42:44.499 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 16:42:44.610 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 111.0256ms
2025-09-12 16:42:55.286 +07:00 [INF] Request starting HTTP/2 DELETE https://localhost:7077/api/User/8 - null null
2025-09-12 16:42:55.292 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:42:55.292 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:42:55.295 +07:00 [INF] Executing endpoint 'UserController.DeleteUser (EVServiceCenter.API)'
2025-09-12 16:42:55.318 +07:00 [INF] Route matched with {action = "DeleteUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteUser(Int32) on controller UserController (EVServiceCenter.API).
2025-09-12 16:42:58.974 +07:00 [INF] Executed DbCommand (76ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[UserID] = @__p_0
2025-09-12 16:42:59.304 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 16:42:59.639 +07:00 [INF] Executed DbCommand (136ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Users]
OUTPUT 1
WHERE [UserID] = @p0;
2025-09-12 16:42:59.653 +07:00 [INF] User deleted: 8
2025-09-12 16:42:59.662 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:42:59.672 +07:00 [INF] Executed action UserController.DeleteUser (EVServiceCenter.API) in 4350.7458ms
2025-09-12 16:42:59.672 +07:00 [INF] Executed endpoint 'UserController.DeleteUser (EVServiceCenter.API)'
2025-09-12 16:42:59.683 +07:00 [INF] Request finished HTTP/2 DELETE https://localhost:7077/api/User/8 - 200 null application/json; charset=utf-8 4397.2892ms
2025-09-12 16:46:12.434 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 177
2025-09-12 16:46:12.465 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:46:12.465 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:46:12.467 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:46:12.472 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:46:12.658 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:46:12.676 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:46:13.068 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 16:46:13.091 +07:00 [INF] User registered: nghiapham
2025-09-12 16:46:13.133 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:46:13.159 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 687.1412ms
2025-09-12 16:46:13.159 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:46:13.160 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 725.8775ms
2025-09-12 16:46:58.473 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 63
2025-09-12 16:46:58.502 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:46:58.505 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:46:58.505 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:46:58.508 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:46:58.555 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 16:46:58.883 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 16:46:58.921 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 16:46:58.922 +07:00 [INF] User logged in: nghiapham
2025-09-12 16:46:58.926 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:46:58.926 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 418.1871ms
2025-09-12 16:46:58.926 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:46:58.927 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 453.8501ms
2025-09-12 16:47:25.091 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 63
2025-09-12 16:47:25.095 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:47:25.095 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:47:25.095 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:47:25.096 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:47:25.099 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 16:47:25.297 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 16:47:25.301 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 16:47:25.302 +07:00 [INF] User logged in: nghiapham
2025-09-12 16:47:25.302 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:47:25.302 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 206.5524ms
2025-09-12 16:47:25.302 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:47:25.303 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 211.867ms
2025-09-12 16:47:28.567 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 63
2025-09-12 16:47:28.567 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:47:28.567 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:47:28.567 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:47:28.567 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:47:28.570 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 16:47:28.772 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 16:47:28.783 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 16:47:28.783 +07:00 [INF] User logged in: nghiapham
2025-09-12 16:47:28.784 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:47:28.784 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 216.5419ms
2025-09-12 16:47:28.784 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 16:47:28.784 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 217.6296ms
2025-09-12 16:48:04.388 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 180
2025-09-12 16:48:04.389 +07:00 [INF] CORS policy execution failed.
2025-09-12 16:48:04.389 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 16:48:04.389 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:48:04.393 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 16:48:04.432 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:48:04.436 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 16:48:04.607 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 16:48:04.634 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'EVServiceCenter.Core.Entities.EVDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c8c1d70f-b06a-45bc-88af-02321f58429b
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of UNIQUE KEY constraint 'UQ__Users__1F642548C42F5823'. Cannot insert duplicate key in object 'dbo.Users'. The duplicate key value is (<NULL>).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c8c1d70f-b06a-45bc-88af-02321f58429b
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-12 16:48:04.990 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 16:48:04.991 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 574.6886ms
2025-09-12 16:48:04.991 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 16:48:04.991 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/json; charset=utf-8 603.7644ms
2025-09-12 18:31:52.510 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-12 18:31:52.529 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-12 18:31:52.549 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-09-12 18:31:52.597 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-09-12 18:31:52.602 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-12 18:31:52.603 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-09-12 18:31:52.609 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-09-12 18:31:52.614 +07:00 [INF] Applying migration '20250912112421_MakeEmployeeCodeNullable'.
2025-09-12 18:31:52.813 +07:00 [ERR] Failed executing DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AppointmentStatus] (
    [StatusID] int NOT NULL IDENTITY,
    [StatusName] nvarchar(50) NOT NULL,
    [StatusColor] nvarchar(10) NULL,
    [Description] nvarchar(200) NULL,
    [IsActive] bit NULL DEFAULT CAST(1 AS bit),
    [DisplayOrder] int NULL DEFAULT 0,
    CONSTRAINT [PK__Appointm__C8EE204358988DD1] PRIMARY KEY ([StatusID])
);
2025-09-12 18:41:17.485 +07:00 [INF] User profile is available. Using 'C:\Users\ADMIN\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-12 18:41:17.760 +07:00 [INF] Now listening on: https://localhost:7077
2025-09-12 18:41:17.761 +07:00 [INF] Now listening on: http://localhost:5153
2025-09-12 18:41:17.792 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-12 18:41:17.792 +07:00 [INF] Hosting environment: Development
2025-09-12 18:41:17.792 +07:00 [INF] Content root path: C:\Users\ADMIN\Desktop\SWP\BackEnd\EVServiceCenter\EVServiceCenter.API
2025-09-12 18:41:18.586 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/ - null null
2025-09-12 18:41:18.807 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/ - 404 0 null 225.9016ms
2025-09-12 18:41:18.809 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7077/, Response status code: 404
2025-09-12 18:41:21.632 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - null null
2025-09-12 18:41:21.632 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/_vs/browserLink - null null
2025-09-12 18:41:21.645 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_framework/aspnetcore-browser-refresh.js - 200 16523 application/javascript; charset=utf-8 13.8117ms
2025-09-12 18:41:21.660 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.1247ms
2025-09-12 18:41:21.750 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - null null
2025-09-12 18:41:21.822 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.9964ms
2025-09-12 18:41:25.394 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User - null null
2025-09-12 18:41:25.400 +07:00 [INF] Executing endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:41:25.433 +07:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers() on controller UserController (EVServiceCenter.API).
2025-09-12 18:41:28.677 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
2025-09-12 18:41:28.729 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-12 18:41:28.738 +07:00 [INF] Executed action UserController.GetAllUsers (EVServiceCenter.API) in 3301.4481ms
2025-09-12 18:41:28.739 +07:00 [INF] Executed endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:41:28.746 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User - 200 null application/json; charset=utf-8 3352.409ms
2025-09-12 18:43:15.580 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 198
2025-09-12 18:43:15.590 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:43:15.590 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:43:15.593 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:43:15.602 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:43:15.694 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-12 18:43:15.714 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 111.6317ms
2025-09-12 18:43:15.714 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:43:15.714 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 400 null application/problem+json; charset=utf-8 134.3361ms
2025-09-12 18:44:14.551 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 175
2025-09-12 18:44:14.553 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:44:14.553 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:44:14.553 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:14.553 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:44:14.825 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:14.848 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:15.496 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 18:44:15.523 +07:00 [INF] User registered: PhamNghia
2025-09-12 18:44:15.597 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:44:15.633 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 1079.6958ms
2025-09-12 18:44:15.633 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:15.634 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 1085.5748ms
2025-09-12 18:44:32.383 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 165
2025-09-12 18:44:32.383 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:44:32.383 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:44:32.383 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:32.383 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:44:32.394 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:32.398 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:32.707 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 18:44:32.707 +07:00 [INF] User registered: LeMinh
2025-09-12 18:44:32.709 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:44:32.709 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 326.1779ms
2025-09-12 18:44:32.709 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:32.710 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 327.059ms
2025-09-12 18:44:50.210 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 168
2025-09-12 18:44:50.210 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:44:50.210 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:44:50.210 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:50.211 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:44:50.220 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:50.221 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:44:50.365 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 18:44:50.365 +07:00 [INF] User registered: TranHieu
2025-09-12 18:44:50.366 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:44:50.366 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 155.7275ms
2025-09-12 18:44:50.366 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:44:50.367 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 156.5248ms
2025-09-12 18:45:11.413 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 54
2025-09-12 18:45:11.440 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:45:11.440 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:45:11.440 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 18:45:11.442 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:11.537 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 18:45:11.733 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 18:45:11.763 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 18:45:11.765 +07:00 [INF] User logged in: TranHieu
2025-09-12 18:45:11.768 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:45:11.768 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 325.8223ms
2025-09-12 18:45:11.768 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 18:45:11.768 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 355.4406ms
2025-09-12 18:45:25.572 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User - null null
2025-09-12 18:45:25.572 +07:00 [INF] Executing endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:45:25.573 +07:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers() on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:25.575 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
2025-09-12 18:45:25.577 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-12 18:45:25.577 +07:00 [INF] Executed action UserController.GetAllUsers (EVServiceCenter.API) in 4.4872ms
2025-09-12 18:45:25.577 +07:00 [INF] Executed endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:45:25.577 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User - 200 null application/json; charset=utf-8 5.2761ms
2025-09-12 18:45:36.470 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User - null null
2025-09-12 18:45:36.472 +07:00 [INF] Executing endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:45:36.473 +07:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers() on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:36.480 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username]
FROM [Users] AS [u]
2025-09-12 18:45:36.481 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-12 18:45:36.481 +07:00 [INF] Executed action UserController.GetAllUsers (EVServiceCenter.API) in 8.7103ms
2025-09-12 18:45:36.481 +07:00 [INF] Executed endpoint 'UserController.GetAllUsers (EVServiceCenter.API)'
2025-09-12 18:45:36.482 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User - 200 null application/json; charset=utf-8 11.8573ms
2025-09-12 18:45:41.650 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User/1 - null null
2025-09-12 18:45:41.651 +07:00 [INF] Executing endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:41.656 +07:00 [INF] Route matched with {action = "GetUserById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserById(Int32) on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:41.664 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 18:45:41.665 +07:00 [INF] Executing OkObjectResult, writing value of type 'EVServiceCenter.Core.DTOs.Response.UserResponseDto'.
2025-09-12 18:45:41.665 +07:00 [INF] Executed action UserController.GetUserById (EVServiceCenter.API) in 8.8977ms
2025-09-12 18:45:41.665 +07:00 [INF] Executed endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:41.665 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User/1 - 200 null application/json; charset=utf-8 14.594ms
2025-09-12 18:45:46.724 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User/2 - null null
2025-09-12 18:45:46.725 +07:00 [INF] Executing endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:46.725 +07:00 [INF] Route matched with {action = "GetUserById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserById(Int32) on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:46.730 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 18:45:46.731 +07:00 [INF] Executing OkObjectResult, writing value of type 'EVServiceCenter.Core.DTOs.Response.UserResponseDto'.
2025-09-12 18:45:46.731 +07:00 [INF] Executed action UserController.GetUserById (EVServiceCenter.API) in 5.9445ms
2025-09-12 18:45:46.731 +07:00 [INF] Executed endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:46.731 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User/2 - 200 null application/json; charset=utf-8 6.483ms
2025-09-12 18:45:50.468 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7077/api/User/3 - null null
2025-09-12 18:45:50.468 +07:00 [INF] Executing endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:50.468 +07:00 [INF] Route matched with {action = "GetUserById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserById(Int32) on controller UserController (EVServiceCenter.API).
2025-09-12 18:45:50.470 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 18:45:50.470 +07:00 [INF] Executing OkObjectResult, writing value of type 'EVServiceCenter.Core.DTOs.Response.UserResponseDto'.
2025-09-12 18:45:50.471 +07:00 [INF] Executed action UserController.GetUserById (EVServiceCenter.API) in 2.4254ms
2025-09-12 18:45:50.471 +07:00 [INF] Executed endpoint 'UserController.GetUserById (EVServiceCenter.API)'
2025-09-12 18:45:50.471 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7077/api/User/3 - 200 null application/json; charset=utf-8 3.0492ms
2025-09-12 18:46:56.195 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/register - application/json 170
2025-09-12 18:46:56.220 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:46:56.220 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:46:56.221 +07:00 [INF] Executing endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:46:56.221 +07:00 [INF] Route matched with {action = "Register", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(EVServiceCenter.Core.DTOs.Request.RegisterRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:46:56.225 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Username] = @__username_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:46:56.228 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-09-12 18:46:56.357 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (Size = 100), @p6='?' (DbType = Date), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Date), @p10='?' (Size = 64) (DbType = Binary), @p11='?' (Size = 32) (DbType = Binary), @p12='?' (Size = 20), @p13='?' (Size = 500), @p14='?' (DbType = Int32), @p15='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedDate], [Department], [Email], [EmployeeCode], [FullName], [HireDate], [IsActive], [LastLoginDate], [PasswordExpiryDate], [PasswordHash], [PasswordSalt], [PhoneNumber], [ProfilePicture], [RoleID], [Salary], [Username])
OUTPUT INSERTED.[UserID], INSERTED.[FailedLoginAttempts]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-09-12 18:46:56.357 +07:00 [INF] User registered: NguyenAn
2025-09-12 18:46:56.357 +07:00 [INF] Executing CreatedAtActionResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:46:56.358 +07:00 [INF] Executed action UserController.Register (EVServiceCenter.API) in 136.915ms
2025-09-12 18:46:56.358 +07:00 [INF] Executed endpoint 'UserController.Register (EVServiceCenter.API)'
2025-09-12 18:46:56.358 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/register - 201 null application/json; charset=utf-8 162.966ms
2025-09-12 18:47:36.165 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7077/api/User/login - application/json 54
2025-09-12 18:47:36.166 +07:00 [INF] CORS policy execution failed.
2025-09-12 18:47:36.166 +07:00 [INF] Request origin https://localhost:7077 does not have permission to access the resource.
2025-09-12 18:47:36.166 +07:00 [INF] Executing endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 18:47:36.166 +07:00 [INF] Route matched with {action = "Login", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(EVServiceCenter.Core.DTOs.Request.LoginRequestDto) on controller UserController (EVServiceCenter.API).
2025-09-12 18:47:36.173 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__username_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[Username] = @__username_0 AND [u].[IsActive] = CAST(1 AS bit)
2025-09-12 18:47:36.292 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserID], [u].[CreatedBy], [u].[CreatedDate], [u].[Department], [u].[Email], [u].[EmployeeCode], [u].[FailedLoginAttempts], [u].[FullName], [u].[HireDate], [u].[IsActive], [u].[LastLoginDate], [u].[PasswordExpiryDate], [u].[PasswordHash], [u].[PasswordSalt], [u].[PhoneNumber], [u].[ProfilePicture], [u].[RoleID], [u].[Salary], [u].[Username], [u0].[RoleID], [u0].[CreatedDate], [u0].[Description], [u0].[IsActive], [u0].[Permissions], [u0].[RoleName]
FROM [Users] AS [u]
INNER JOIN [UserRoles] AS [u0] ON [u].[RoleID] = [u0].[RoleID]
WHERE [u].[UserID] = @__id_0
2025-09-12 18:47:36.300 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (Size = 100), @p4='?' (Size = 20), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Date), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Date), @p11='?' (Size = 64) (DbType = Binary), @p12='?' (Size = 32) (DbType = Binary), @p13='?' (Size = 20), @p14='?' (Size = 500), @p15='?' (DbType = Int32), @p16='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [CreatedBy] = @p0, [CreatedDate] = @p1, [Department] = @p2, [Email] = @p3, [EmployeeCode] = @p4, [FailedLoginAttempts] = @p5, [FullName] = @p6, [HireDate] = @p7, [IsActive] = @p8, [LastLoginDate] = @p9, [PasswordExpiryDate] = @p10, [PasswordHash] = @p11, [PasswordSalt] = @p12, [PhoneNumber] = @p13, [ProfilePicture] = @p14, [RoleID] = @p15, [Salary] = @p16, [Username] = @p17
OUTPUT 1
WHERE [UserID] = @p18;
2025-09-12 18:47:36.301 +07:00 [INF] User logged in: TranHieu
2025-09-12 18:47:36.301 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[EVServiceCenter.Core.DTOs.Response.UserResponseDto, EVServiceCenter.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-12 18:47:36.301 +07:00 [INF] Executed action UserController.Login (EVServiceCenter.API) in 134.9411ms
2025-09-12 18:47:36.301 +07:00 [INF] Executed endpoint 'UserController.Login (EVServiceCenter.API)'
2025-09-12 18:47:36.301 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7077/api/User/login - 200 null application/json; charset=utf-8 135.6944ms
